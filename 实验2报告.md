# 实验二：对话行为与交互策略建模 - 实验报告

## 实验目的与要求

### 主要目标
1. **掌握对话行为与交互策略建模的基本概念**：理解对话行为（speech acts）和交互策略（interaction strategy）在对话语义分析中的互补关系。

2. **实现从零标注的语义行为识别**：利用大语言模型自动生成对话中每句话的行为类别标签。

3. **联合分析**：分析对话行为类别、交互策略与诈骗标签之间的关系，探索是否存在特定的组合模式。

## 方法与步骤

### （一）数据准备

#### 数据源
- 使用与实验1相同的中文对话数据集
- 数据字段包括：
  - `specific_dialogue_content`：对话文本
  - `interaction_strategy`：交互策略标签（Clarity、Personalization、Relevance、Completeness、Truthfulness等）
  - `is_fraud`：是否诈骗（0=非诈骗，1=诈骗）
  - `call_type`：呼叫类型
  - `fraud_type`：诈骗类型

#### 数据预处理
1. **对话轮次划分**：按行解析对话内容，提取每一轮的left端发言
2. **句子提取**：从对话文本中提取所有left端（主动方/主要说话方）的句子
3. **数据过滤**：过滤掉没有有效left句子的对话

**处理结果**：
- 原始数据：14,363条对话记录
- 有效对话：14,363条（全部包含left端句子）

### （二）对话行为类别自动识别

#### 任务定义
利用语言模型为每个left端句子生成对应的对话行为类别。

#### 对话行为类别定义
- **请求类（Request）**：询问、索取信息、提出要求
- **陈述类（Statement）**：提供信息、描述事实
- **确认类（Confirmation）**：肯定、确认对方观点
- **拒绝类（Rejection）**：否定、拒绝请求或提议
- **其他类（Other）**：不属于以上类别的发言

#### 实现方法
由于实验环境限制，暂时使用规则-based的模拟预测器代替真实的LLM API：

```python
def mock_llm_predict(sentence):
    sentence_lower = sentence.lower()
    if any(word in sentence_lower for word in ['吗', '呢', '什么', '怎么', '能否', '可以']):
        return "请求"
    elif any(word in sentence_lower for word in ['是', '有', '没有', '就是', '但是']):
        return "陈述"
    elif any(word in sentence_lower for word in ['是的', '对的', '好的', '没错']):
        return "确认"
    elif any(word in sentence_lower for word in ['不', '不行', '拒绝', '不同意']):
        return "拒绝"
    else:
        return "其他"
```

#### 处理结果
- 成功为14,363条对话的left端句子生成了行为类别标签
- 每条对话生成了行为类别计数向量：[请求数, 陈述数, 确认数, 拒绝数, 其他数]

### （三）对话交互策略、对话行为类别、诈骗标签的联合分析

#### 任务一：分层共现统计（行为 × 策略 × 诈骗）

##### 分析方法
1. **策略分布分析**：
   - **非诈骗对话**：Factual Authenticity / Truthfulness (2821), Relevance (2686), Clarity (752), Personalization (34)
   - **诈骗对话**：Relevance (5693), Clarity (1547), Personalization (77), Completeness (16), Factual Authenticity / Truthfulness (4)

2. **行为类别分布分析**：
   - **非诈骗对话**：陈述类占比最高，其次是请求类
   - **诈骗对话**：请求类占比最高，其次是陈述类

3. **组合风险分析**：
   - 计算每个"策略×行为"组合的诈骗概率
   - 计算相对风险比（组合诈骗率 / 总体诈骗率）

##### 关键发现

**高风险组合（风险比>1.2）**：
1. **Completeness + 所有行为类别**：风险比=1.857（最高风险）
   - Completeness策略下的所有行为类别都显示出极高的诈骗倾向
   - 所有组合的诈骗率达到100%

2. **Clarity + 陈述**：风险比=1.306
   - 在清晰度策略下进行陈述的诈骗概率较高

3. **Relevance + 陈述**：风险比=1.280
   - 在相关性策略下进行陈述的诈骗概率较高

4. **Relevance + 请求**：风险比=1.252
   - 在相关性策略下进行请求的诈骗概率较高

5. **Personalization + 陈述**：风险比=1.238
   - 在个性化策略下进行陈述的诈骗概率较高

**低风险组合（风险比<0.8）**：
- **Factual Authenticity / Truthfulness + 请求**：风险比=0.0（完全无风险）
- **Factual Authenticity / Truthfulness + 确认**：风险比=0.0

#### 任务二：轻量解释建模（量化组合对诈骗概率的影响）

##### 模型构建
1. **特征工程**：
   - 策略one-hot编码
   - 行为类别占比特征（每个类别的占比）
   - 策略×行为组合特征

2. **模型选择**：
   - **逻辑回归**：提供可解释的系数
   - **决策树**：提供特征重要性

##### 模型性能
- **逻辑回归**：准确率76.05%，F1=0.796
- **决策树**：准确率76.89%，F1=0.801

##### 特征重要性分析

**逻辑回归关键特征**：
1. **strategy_Factual Authenticity / Truthfulness** (系数=-4.22)：**最强的保护因素**
   - 真实性策略显著降低诈骗概率

2. **确认_ratio** (系数=-3.16)：**强保护因素**
   - 确认类行为的增加显著降低诈骗概率

3. **Factual Authenticity / Truthfulness_请求** (系数=-1.78)：**强保护因素**
   - 在真实性策略下进行请求的行为模式

4. **strategy_Completeness** (系数=1.52)：**最强风险因素**
   - Completeness策略显著增加诈骗概率

5. **陈述_ratio** (系数=1.24)：**风险因素**
   - 陈述类行为的增加会提高诈骗概率

**决策树关键特征**：
1. **strategy_Factual Authenticity / Truthfulness** (重要性=74.5%)：**决定性特征**
2. **确认_ratio** (重要性=19.8%)：**重要特征**

## 实验结论

### 主要发现

1. **诈骗检测的关键模式**：
   - **Completeness策略**：所有行为类别组合都显示极高风险（风险比=1.857）
   - **Factual Authenticity / Truthfulness策略**：所有行为类别组合都显示极低风险

2. **行为类别的影响**：
   - **确认类行为**：强烈降低诈骗概率（保护因素）
   - **陈述类行为**：增加诈骗概率（风险因素）
   - **请求类行为**：在不同策略下有不同表现

3. **策略×行为的互补关系**：
   - 交互策略和对话行为确实存在互补关系
   - 某些策略下的特定行为模式具有很强的指示意义

### 模型解释性
- 逻辑回归模型提供了可解释的系数，能够量化每个特征对诈骗概率的影响
- Factual Authenticity / Truthfulness策略是最大的保护因素
- Completeness策略是最大的风险因素

### 局限性与改进方向
1. **LLM模拟**：当前使用规则-based模拟器，实际应用中应使用真实的LLM API
2. **特征粒度**：可以进一步细化行为类别定义
3. **时序信息**：可以考虑对话的时序特征和上下文关系

### 实际应用价值
- 为诈骗检测系统提供了可解释的行为+策略联合特征
- 发现了多个高风险的对话模式组合
- 为对话质量评估提供了新的指标体系

---

**实验完成时间**：2025年12月29日
**数据处理量**：14,363条对话记录
**生成文件**：
- `behavior_strategy_analysis.csv`：行为×策略组合风险分析
- `model_features.csv`：模型特征数据
- `exp2.py`：完整实验代码
